{% extends 'base.html' %}
{% load static %}


{% block content %}


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boat Wireless Speaker â€“ Product Detail</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --v1-100-bg:#f5f6f8; 
      --v1-110-card:#ffffff; 
      --v1-120-text:#0e1220; 
      --v1-130-sub:#6b7280; 
      --v1-140-brand:#2457ff; 
      --v1-150-green:#17a34a; 
      --v1-160-yellow:#f59e0b; 
      --v1-170-gray:#e5e7eb; 
      --v1-180-border:#d1d5db; 
      --v1-190-shadow:0 10px 25px rgba(16,24,40,.08);
      --v1-200-radius:18px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--v1-100-bg);color:var(--v1-120-text)}
    .v1-wrap-100{max-width:1120px;margin:20px auto;padding:0 10px}
    .v1-product-101{display:grid;grid-template-columns:600px 1fr;gap:32px;align-items:start}
    
    /* Ensure wrap is responsive */
    @media (max-width: 1400px) {
      .v1-wrap-100{padding:0 15px}
    }

    /* left gallery */
    .v1-gallery-110{display:grid;grid-template-columns:110px 1fr;gap:15px}
    .v1-thumbs-130{display:grid;gap:7px}
    .v1-thumb-131{height:110px;width:110px;border-radius:14px;background:#ddd;box-shadow:var(--v1-190-shadow);border:1px solid var(--v1-180-border)}
    /* Thumbnails should look clickable */
    .v1-thumb-131 {
      cursor: pointer;          /* pointer cursor */
      margin: 0 4px;            /* decrease gap between thumbnails */
      transition: transform 0.2s ease;
    }

    .v1-thumb-131:hover {
      transform: scale(1.05);   /* small hover zoom effect */
    }

    .v1-thumb-131.active {
     border: 2px solid #007bff;   /* highlight active */
     border-radius: 6px;
     box-shadow: 0 0 10px rgba(0, 123, 255, 0.5); /* glow effect */
    }

    .v1-hero-120{position:relative;border-radius:22px;overflow:hidden;background:linear-gradient(145deg,#e8ecff,#cfd8ff 40%,#b9c7ff);min-height:520px;display:flex;align-items:flex-end;justify-content:center;box-shadow:var(--v1-190-shadow)}
    .v1-hero-120 .v1-hero-img-121{width:100%;height:100%;object-fit:cover;display:block}
    .v1-hero-120 {
      position: relative;
      overflow: hidden;
    }

    .v1-hero-img-121 {
      width: 100%;
      cursor: zoom-in;
      transition: opacity 0.2s ease;
    }



    /* Promo text inside hero */
    .v1-hero-badge-122{position:absolute;left:16px;top:20px;color:#fff}
    .v1-hero-hrs-123{display:flex;align-items:flex-end;gap:12px}
    .v1-hero-hrs-123 .v1-num-124{font-size:140px;line-height:.85;font-weight:800;letter-spacing:-2px}
    .v1-hero-hrs-123 .v1-hrs-125{font-weight:800;font-size:32px;transform:translateY(-10px)}
    .v1-hero-play-126{font-size:20px;margin-top:-6px;letter-spacing:.08em}
    .v1-hero-foot-127{position:absolute;left:16px;bottom:16px;background:rgba(0,0,0,.25);color:#fff;padding:14px 18px;border-radius:14px;backdrop-filter:blur(4px);font-size:14px}

    /* right details */
    .v1-details-200{padding-top:4px}
    .v1-title-201{font-size:40px;line-height:1.1;margin:0 0 8px;font-weight:800}
    .v1-sub-202{color:var(--v1-130-sub);font-size:14px;margin-bottom:18px}

    .v1-price-210{display:flex;align-items:baseline;gap:14px;margin:6px 0 4px}
    .v1-price-now-211{font-size:22px;font-weight:700}
    .v1-price-sale-212{font-size:14px;color:var(--v1-130-sub)}
    .v1-price-strike-213{position:relative}
    .v1-price-strike-213::after{content:"";position:absolute;left:0;right:0;top:50%;height:2px;background:#000;opacity:.35;transform:rotate(-5deg)}
    .v1-tax-214{font-size:12px;color:var(--v1-130-sub);margin-top:2px}

    .v1-stars-220{display:flex;align-items:center;gap:8px;margin:10px 0 16px}
    .v1-stars-220 .rating-star{display:flex;flex-direction:row;margin-right:5px}
    .v1-stars-220 .rating-star i{margin:0;font-size:18px;float:none}
    .v1-stars-220 .v1-rev-222{font-size:12px;color:var(--v1-130-sub)}

    .v1-choose-230{font-size:14px;margin:18px 0 8px}
    .v1-swatches-231{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px}
    /* swatch pill styles */
    .v1-pill-232 {
      padding: 8px 16px;
      border-radius: 999px;
      background: #f3f4f6;
      border: 2px solid var(--v1-180-border);
      font-size: 13px;
      cursor: pointer;           /* pointer cursor */
      transition: all 0.2s ease;
    }

    .v1-pill-232.active {
      background: var(--v1-140-brand);
      color: #fff;
      border-color: var(--v1-140-brand);
      font-weight: 600;
    }
    .v1-min-240{font-size:13px;color:var(--v1-130-sub);margin:14px 0 16px}

    .v1-feats-250 {
      display: flex;
      flex-wrap: wrap;   /* allows row wrapping */
      gap: 16px;         /* space between features */
      margin: 20px 0;   /* space around section */
    }

    .v1-feat-251 {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #111;
    }

    .v1-feat-251 .v1-ico-252 {
      font-size: 14px;
      line-height: 1.4;
      color: #111;
    }

    

    .v1-cta-260{display:flex;gap:14px}
    .v1-btn-261{flex:1;display:inline-flex;justify-content:center;align-items:center;gap:10px;padding:16px 34px;border-radius:14px;font-weight:700;border:1px solid var(--v1-180-border);background:#fff;box-shadow:var(--v1-190-shadow);cursor:pointer;transition:all .2s}
    .v1-btn-261:hover{transform:translateY(-1px)}
    .v1-btn-blue-262{background:#1e40ff;color:#fff;border-color:#1e40ff}
    .v1-btn-green-263{background:#10b981;color:#052e16;border-color:#0ea76a}
    .v1-btn-ico-264{width:25px;height:25px}

    /* card wrapper look */
    .v1-details-card-270{background:var(--v1-110-card);border:1px solid var(--v1-180-border);border-radius:var(--v1-200-radius);padding:18px 20px;display:flex;gap:14px;align-items:center;width:100%;max-width:450px}

    /* responsiveness */
    @media (max-width: 1200px){
      .v1-product-101{grid-template-columns:1fr}
      .v1-title-201{font-size:32px}
      .v1-gallery-110{grid-template-columns:1fr}
      .v1-thumbs-130{order:2;grid-template-columns:repeat(4,1fr)}
      .v1-thumb-131{height:90px;width:90px}
      .v1-hero-120{min-height:420px}
      .v1-details-card-270{max-width:100%}
      .v1-wrap-100{padding:0 15px}
      .v1-cta-260{flex-direction:column}
      .v1-btn-261{width:100%}
    }
    
    @media (max-width: 768px){
      .v1-product-101{grid-template-columns:1fr;gap:16px}
      .v1-title-201{font-size:26px;line-height:1.2}
      .v1-sub-202{font-size:13px}
      .v1-price-now-211{font-size:20px}
      .v1-gallery-110{grid-template-columns:1fr}
      .v1-thumbs-130{grid-template-columns:repeat(4,1fr);gap:5px}
      .v1-thumb-131{height:70px;width:70px}
      .v1-hero-120{min-height:350px}
      .v1-hero-hrs-123 .v1-num-124{font-size:100px}
      .v1-hero-hrs-123 .v1-hrs-125{font-size:24px}
      .v1-details-200{padding-top:0}
      .v1-details-card-270{max-width:100%;flex-direction:column;gap:10px}
      .v1-btn-261{font-size:14px;padding:12px 20px}
      .v1-wrap-100{max-width:100%;margin:10px auto;padding:0 10px}
      .v1-choose-230{font-size:13px}
      .v1-feats-250{gap:12px;margin:15px 0}
      .v1-feat-251{font-size:12px;gap:6px}
    }
    
    @media (max-width: 576px){
      .v1-product-101{grid-template-columns:1fr;gap:12px}
      .v1-wrap-100{max-width:100%;margin:5px auto;padding:0 8px}
      .v1-title-201{font-size:22px;line-height:1.2;margin-bottom:6px}
      .v1-sub-202{font-size:12px;margin-bottom:12px}
      .v1-price-now-211{font-size:18px}
      .v1-price-sale-212{font-size:12px}
      .v1-gallery-110{grid-template-columns:1fr;gap:10px}
      .v1-thumbs-130{grid-template-columns:repeat(4,1fr);gap:4px;order:2}
      .v1-thumb-131{height:60px;width:60px}
      .v1-hero-120{min-height:300px}
      .v1-hero-badge-122{left:8px;top:10px;font-size:12px}
      .v1-hero-foot-127{left:8px;bottom:8px;padding:10px 12px;font-size:12px}
      .v1-hero-hrs-123 .v1-num-124{font-size:80px;letter-spacing:-1px}
      .v1-hero-hrs-123 .v1-hrs-125{font-size:20px;transform:translateY(-8px)}
      .v1-hero-play-126{font-size:16px;margin-top:-4px}
      .v1-choose-230{font-size:12px;margin:12px 0 6px}
      .v1-swatches-231{gap:8px}
      .v1-pill-232{padding:6px 12px;font-size:12px}
      .v1-min-240{font-size:11px;margin:10px 0 12px}
      .v1-feats-250{gap:10px;margin:12px 0}
      .v1-feat-251{font-size:11px;gap:4px}
      .v1-details-card-270{padding:12px 15px;gap:8px;flex-direction:column;max-width:100%}
      .v1-btn-261{font-size:13px;padding:10px 16px;gap:6px}
      .v1-btn-ico-264{width:20px;height:20px}
      .v1-cta-260{gap:8px;flex-direction:column}
      .container220{padding:0}
    }
  </style>
</head>
<body>
  <main class="v1-wrap-100">
    <section class="v1-product-101">
      {% if single_product %}
      <!-- Left: Gallery -->
      <div class="v1-gallery-110">
        <div class="v1-thumbs-130">
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image1.url }}" alt="Thumbnail 1"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image2.url }}" alt="Thumbnail 2"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image3.url }}" alt="Thumbnail 3"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image4.url }}" alt="Thumbnail 4"></a>
        </div>

        <div class="v1-hero-120">
          <!-- If you have the product image, place it below and remove the gradient bg -->
          <img id="main-product-img" class="v1-hero-img-121" src="{{ single_product.image1.url }}" alt="Boat Earphones"> 
          
        </div>
      </div>

      <!-- Right: Details -->
       <form action="{% url 'carts:add_cart' single_product.id %}" method="POST">
        {% csrf_token %}
        <div class="container220">
          <div class="v1-details-200">
            <h1 class="v1-title-201">{{ single_product.product_name }}</h1>
            <p class="v1-sub-202">{{ single_product.discription }}</p>

            <div class="v1-price-210">
              <div class="v1-price-now-211">Rs.{{ single_product.price }}</div>
              {% if single_product.old_price %}
                <div class="v1-price-sale-212">Sale price <span class="v1-price-strike-213">Rs.{{ single_product.old_price }}</span></div>
              {% endif %}
            </div>
            <div class="v1-tax-214">NRP (Inclusive of all taxes)</div>


            <div class="v1-choose-230">Choose your color:</div>
            <div class="v1-swatches-231">
              <input type="hidden" name="color" id="selected-color-input">
              {% for i in single_product.variation_set.colors %}
                <span class="v1-pill-232" data-color="{{ i.variation_value | lower }}">
                  {{ i.variation_value | capfirst }}
                </span>

              {% endfor %}
            </div>

            <!-- <div class="v1-min-240">Minimum Order : 45 Units</div> -->

            <div class="v1-feats-250">
              {% if single_product %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature1 }}</p>
              </div>
              {% endif %}
              {% if single_product.feature2 %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature2 }}</p>
              </div>
              {% endif %}
              {% if single_product.feature3 %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature3 }}</p>
              </div>
              {% endif %}
            </div>

            <div class="v1-details-card-270">
              {% if single_product.stock <= 0 %}
				        <h5 class="text-danger" >Out of Stock</h5>
			        {% else %}
              <!-- Add to cart -->
                <button class="v1-btn-261 v1-btn-blue-262" type="submit">
                  <!-- Shopping cart icon -->
                  <svg class="v1-btn-ico-264" xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#E3E3E3">
                    <path d="M7 18q-.825 0-1.412-.587Q5 16.825 5 16t.588-1.413Q6.175 14 7 14t1.413.587Q9 15.175 9 16t-.587 1.413Q7.825 18 7 18Zm10 0q-.825 0-1.412-.587Q15 16.825 15 16t.588-1.413Q16.175 14 17 14t1.413.587Q19 15.175 19 16t-.587 1.413Q17.825 18 17 18ZM7 6.6l1.45 2.9h7.95l2.7-5.4H7ZM5.15 4h15.7q.45 0 .65.388.2.387-.05.787l-3.6 7.25q-.275.525-.75.85-.475.325-1.1.325H8.1l-.75 1.4h10.85v1.5H6q-.675 0-1.013-.6-.337-.6 0-1.2L6.3 11l-2.75-5.5h1.6L7 6.6Z"/>
                  </svg>
                  Add to Cart
                </button>

                <!-- WhatsApp Direct Order Button -->
                <button class="v1-btn-261 v1-btn-green-263" id="whatsapp-direct-btn" type="button" style="background-color: #25D366; border-color: #25D366;">
                  <!-- WhatsApp icon -->
                  <i class="fab fa-whatsapp" style="font-size: 20px;"></i>
                  WhatsApp Us
                </button>
                
              {% endif %}
              
            </div>

            <!-- Hidden data for WhatsApp button -->
            <script type="application/json" id="product-data" style="display: none;">
            {
                "product_name": "{{ single_product.product_name }}",
                "price": {{ single_product.price }},
                "image_url": "{{ single_product.image1.url }}",
                "stock": {{ single_product.stock }},
                "product_id": {{ single_product.id }}
            }
            </script>


          </div>
        </div>
       </form>
      {% else %}
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-warning" role="alert">
                    <h4 class="alert-heading">Product Not Found!</h4>
                    <p>The product you're looking for doesn't exist or is no longer available.</p>
                    <hr>
                    <p class="mb-0">
                        <a href="{% url 'store' %}" class="btn btn-primary">Back to Store</a>
                    </p>
                </div>
            </div>
        </div>
      {% endif %}
      
    </section>
    <br>

    <div class="row">
            <div class="col-md-9">
{% include 'includes/alerts.html' %}


      {%  for review in reviews %}
        <article class="box mb-3">
          <div class="icontext w-100">

            <div class="text">
              <span class="date text-muted float-md-right">{{review.updated_date}}</span>  
              <h6 class="mb-1">{{review.user.full_name}} </h6>
              <div class="rating-star">
                <!-- 1 star -->
                <i class="fa {% if review.rating >= 1 %}fa-star{% elif review.rating >= 0.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 2 star -->
                <i class="fa {% if review.rating >= 2 %}fa-star{% elif review.rating >= 1.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 3 star -->
                <i class="fa {% if review.rating >= 3 %}fa-star{% elif review.rating >= 2.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 4 star -->
                <i class="fa {% if review.rating >= 4 %}fa-star{% elif review.rating >= 3.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 5 star -->
                <i class="fa {% if review.rating >= 5 %}fa-star{% elif review.rating >= 4.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
              </div>
              
            </div>
          </div> <!-- icontext.// -->
          <div class="mt-3">
            <h6>
              {{review.subject}}
            </h6>
            <p>
              {{review.review}}
            </p>	
          </div>
        </article>
      {% endfor %}

        </div> <!-- col.// -->
    </div> <!-- row.// -->

    <!-- Random Products Section -->
    <section class="py-5 bg-light">
      <div class="container">
        <h3 class="text-center mb-4">You Might Also Like</h3>
        <style>
          .random-products-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
          }
          .random-product-col {
            flex: 0 0 20%;
            max-width: 20%;
            padding: 0 10px;
            margin-bottom: 20px;
          }
          /* Ensure product cards are uniform regardless of uploaded image size */
          .random-product-col .card{
            display: flex;
            flex-direction: column;
            height: 100%;
          }
          .random-product-col .card-img-top{
            width: 100%;
            height: 180px; /* fixed image area */
            object-fit: cover; /* crop large images while preserving aspect */
            display: block;
            border-top-left-radius: 0.25rem;
            border-top-right-radius: 0.25rem;
          }
          .random-product-col .card-body{
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
          }
          .random-product-col .card-title{
            text-align: center;
            min-height: 3em; /* reserve space for title (approx 2 lines) */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 8px;
          }
          .random-product-col .card-text{ margin-bottom: 8px; }
          @media (max-width: 992px) {
            .random-product-col {
              flex: 0 0 33.333%;
              max-width: 33.333%;
            }
          }
          @media (max-width: 768px) {
            .random-product-col {
              flex: 0 0 50%;
              max-width: 50%;
            }
          }
          @media (max-width: 576px) {
            .random-product-col {
              flex: 0 0 100%;
              max-width: 100%;
            }
          }
        </style>
        <div class="random-products-row">
          {% for product in random_products %}
          <div class="random-product-col">
            <div class="card h-100">
              <a href="{{ product.get_url }}">
                <img src="{{ product.image1.url }}" class="card-img-top" alt="{{ product.product_name }}">
              </a>
              <div class="card-body text-center">
                <h6 class="card-title">
                  <a href="{{ product.get_url }}" class="text-decoration-none text-dark">
                    {{ product.product_name|slice:":20" }}{% if product.product_name|length > 20 %}...{% endif %}
                  </a>
                </h6>
                <p class="card-text">
                  <strong>Rs. {{ product.price }}</strong>
                </p>
                <a href="{{ product.get_url }}" class="btn btn-sm btn-outline-primary">View Product</a>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </section>

  </main>
</body>

      <!-- JS  -->

<script>



 const mainImg = document.getElementById("main-product-img");
  const thumbs = document.querySelectorAll(".v1-thumb-131");

  // Thumbnail switching
  thumbs.forEach(thumb => {
    thumb.addEventListener("click", () => {
      mainImg.src = thumb.src;
      thumbs.forEach(t => t.classList.remove("active"));
      thumb.classList.add("active");
    });
  });

  // Zoom effect
  mainImg.addEventListener("mousemove", function (e) {
    const { left, top, width, height } = mainImg.getBoundingClientRect();
    const x = ((e.pageX - left) / width) * 100;
    const y = ((e.pageY - top) / height) * 100;

    mainImg.style.transformOrigin = `${x}% ${y}%`;
    mainImg.style.transform = "scale(2)"; // zoom level
  });

  mainImg.addEventListener("mouseleave", function () {
    mainImg.style.transformOrigin = "center center";
    mainImg.style.transform = "scale(1)";
  });


  // Thumbnail switching (your code stays the same)

  // Swatch selection
  const swatches = document.querySelectorAll(".v1-pill-232");
  if (swatches.length > 0) {
    // default: first one active
    swatches[0].classList.add("active");

    swatches.forEach(swatch => {
      swatch.addEventListener("click", () => {
        swatches.forEach(s => s.classList.remove("active"));
        swatch.classList.add("active");
      });
    });
  }

  // Swatch selection
const selectedColorInput = document.getElementById("selected-color-input");

if (swatches.length > 0) {
  swatches[0].classList.add("active");
  selectedColorInput.value = swatches[0].textContent.trim().toLowerCase();  // Set default

  swatches.forEach(swatch => {
    swatch.addEventListener("click", () => {
      swatches.forEach(s => s.classList.remove("active"));
      swatch.classList.add("active");

      selectedColorInput.value = swatch.textContent.trim().toLowerCase();
    });
  });
}


  // Zoom effect (your code stays the same)


 //whatsapp button
  function chatMe() {
    const phone = "9779848421050";
    const text = "Hello";

    if (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
        window.location.href = `whatsapp://send?phone=${phone}&text=${encodeURIComponent(text)}`;
    } else {
        window.open(`https://wa.me/${phone}?text=${encodeURIComponent(text)}`, "_blank");
    }
  }

  // WhatsApp Direct Order Button Handler
  document.addEventListener('DOMContentLoaded', function() {
    const whatsappBtn = document.getElementById('whatsapp-direct-btn');
    if (whatsappBtn) {
      whatsappBtn.addEventListener('click', function(e) {
        e.preventDefault();

        // Get product data
        const productDataElement = document.getElementById('product-data');
        let productData = {};
        if (productDataElement) {
          productData = JSON.parse(productDataElement.textContent);
        }

        // Get selected variation (color)
        const selectedColorInput = document.getElementById('selected-color-input');
        const selectedColor = selectedColorInput ? selectedColorInput.value : '';

        // Get quantity (default 1)
        const quantity = 1;

        // Build WhatsApp message
        let message = 'ðŸ“¦ *Product Order*\n\n';
        message += '*' + productData.product_name + '*\n';
        
        if (selectedColor) {
          message += 'â€¢ Color: ' + selectedColor.charAt(0).toUpperCase() + selectedColor.slice(1) + '\n';
        }
        
        message += 'Quantity: ' + quantity + '\n';
        message += 'Price per item: Rs. ' + productData.price + '\n';
        message += 'Total: Rs. ' + (productData.price * quantity) + '\n';
        
        if (productData.image_url) {
          message += productData.image_url + '\n';
        }

        // Open WhatsApp
        const phone = '919876543210'; // Configure your WhatsApp number
        const whatsappUrl = 'https://wa.me/' + phone + '?text=' + encodeURIComponent(message);
        window.open(whatsappUrl, '_blank');
      });
    }
  });

</script>



</html>

<!-- ========================= SECTION CONTENT END// ========================= -->

{% endblock %}